From 59a269f4ffd445bde17903717808838f6008def4 Mon Sep 17 00:00:00 2001
From: Sabeel Ansari <Sabeel.Ansari@windriver.com>
Date: Sun, 19 Apr 2020 11:55:42 -0400
Subject: [PATCH] Patch for acmesolver

---
 deploy/charts/cert-manager/templates/deployment.yaml | 1 +
 deploy/charts/cert-manager/values.yaml               | 9 +++++++++
 2 files changed, 10 insertions(+)

diff --git a/deploy/charts/cert-manager/templates/deployment.yaml b/deploy/charts/cert-manager/templates/deployment.yaml
index c25d132..63c6b2e 100644
--- a/deploy/charts/cert-manager/templates/deployment.yaml
+++ b/deploy/charts/cert-manager/templates/deployment.yaml
@@ -103,6 +103,7 @@ spec:
           - --webhook-ca-secret={{ include "webhook.rootCACertificate" . }}
           - --webhook-serving-secret={{ include "webhook.servingCertificate" . }}
           - --webhook-dns-names={{ .Values.webhook.serviceName }},{{ .Values.webhook.serviceName }}.{{ .Release.Namespace }},{{ .Values.webhook.serviceName }}.{{ .Release.Namespace }}.svc
+          - --acme-http01-solver-image={{ .Values.acmesolver.image.repository }}:{{ default .Chart.AppVersion .Values.acmesolver.image.tag }}
           ports:
           - containerPort: 9402
             protocol: TCP
diff --git a/deploy/charts/cert-manager/values.yaml b/deploy/charts/cert-manager/values.yaml
index 2297ade..4dc5b8e 100644
--- a/deploy/charts/cert-manager/values.yaml
+++ b/deploy/charts/cert-manager/values.yaml
@@ -245,3 +245,12 @@ cainjector:
     # If no value is set, the chart's appVersion will be used.
     # tag: canary
     pullPolicy: IfNotPresent
+
+acmesolver:
+
+  image:
+    repository: quay.io/jetstack/cert-manager-acmesolver
+    # Override the image tag to deploy by setting this variable.
+    # If no value is set, the chart's appVersion will be used.
+    # tag: canary
+
-- 
1.8.3.1

