From ff2f5c9c0fb6f0304b2ce763fc8a8cf69e5c47d4 Mon Sep 17 00:00:00 2001
From: Sabeel Ansari <Sabeel.Ansari@windriver.com>
Date: Thu, 23 Apr 2020 09:44:14 -0400
Subject: [PATCH] Patch 0.15.0-alpha1 certmanager for acmesolver

---
 deploy/charts/cert-manager/templates/deployment.yaml | 1 +
 deploy/charts/cert-manager/values.yaml               | 9 +++++++++
 2 files changed, 10 insertions(+)

diff --git a/deploy/charts/cert-manager/templates/deployment.yaml b/deploy/charts/cert-manager/templates/deployment.yaml
index f4bda18..85177c6 100644
--- a/deploy/charts/cert-manager/templates/deployment.yaml
+++ b/deploy/charts/cert-manager/templates/deployment.yaml
@@ -85,6 +85,7 @@ spec:
           - --cluster-resource-namespace=$(POD_NAMESPACE)
         {{- end }}
           - --leader-election-namespace={{ .Values.global.leaderElection.namespace }}
+          - --acme-http01-solver-image={{ .Values.acmesolver.image.repository }}:{{ default .Chart.AppVersion .Values.acmesolver.image.tag }}
         {{- if .Values.extraArgs }}
 {{ toYaml .Values.extraArgs | indent 10 }}
         {{- end }}
diff --git a/deploy/charts/cert-manager/values.yaml b/deploy/charts/cert-manager/values.yaml
index 3b4aef6..bf108f8 100644
--- a/deploy/charts/cert-manager/values.yaml
+++ b/deploy/charts/cert-manager/values.yaml
@@ -241,3 +241,12 @@ cainjector:
     # If no value is set, the chart's appVersion will be used.
     # tag: canary
     pullPolicy: IfNotPresent
+
+acmesolver:
+
+  image:
+    repository: quay.io/jetstack/cert-manager-acmesolver
+    # Override the image tag to deploy by setting this variable.
+    # If no value is set, the chart's appVersion will be used.
+    # tag: canary
+
-- 
1.8.3.1

